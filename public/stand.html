<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport"
		content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />
	<meta http-equiv="X-UA-Compatible" content="ie=edge" />
	<title>Jodit Dev</title>
	<link rel="stylesheet" href="./app.css" />
	<link rel="stylesheet" href="./build/jodit.css" />
	<script src="./build/jodit.js"></script>
	<script src="./build/plugins/speech-recognize/speech-recognize.js"></script>
	<!--		<script src="./build/plugins/debug/debug.js"></script>-->
	<link rel="icon" href="https://xdsoft.net/jodit/pro/favicon.png" />
</head>

<body>
	<style>
		body {
			font-variant-ligatures: contextual;
			text-rendering: optimizespeed;
			-webkit-font-smoothing: antialiased;
		}

		#box {
			position: relative;
			height: 500px;
			padding: 100px;
			margin: 20px;
		}

		@media (max-width: 480px) {
			#box {
				padding: 0;
			}
		}
	</style>
	<div id="box">
		<h1>Jodit Test Document</h1>
		<form id="form" action="sss.php">
			<textarea id="editorNative"></textarea>
			<button id="btn" type="button">click</button>
		</form>
	</div>
	<script>
		const editor = Jodit.make(editorNative, {
			// safeMode: true,
			// iframe: true,
			// buttons: ['paragraph', 'align'],
			// theme: 'dark',
			// textIcons: true,
			controls: {
				paragraph: {
					// component: 'select',
				},
				align: {
					// component: 'select',
				},
				font: {
					// component: 'select',
				},
				fontsize: {
					// component: 'select',
				}
			},
			// fullsize: true,
			cache: true,
			// language: 'ru',
			filebrowser: {
				ajax: {
					url: 'https://xdsoft.net/jodit/finder/'
				}
			},
			uploader: {
				url: 'https://xdsoft.net/jodit/finder/?action=fileUpload'
			},
			language: 'es',

			aiAssistantCallback: (prompt, htmlContents) => {

				//invoke the AI assistant API in http://localhost:7071/api/ExecuteAICompletion, the request is post and the body is a json object with the following structure { "htmlContent": "htmlContents", "userRequest": "prompt" }
				//the response is a json object with the following structure { "success": true, "message": null, "exception": null, "result": "the response from the AI assistant", "messageParameters": null }
				//return a promise that resolves to the response from the AI assistant
				return new Promise((resolve, reject) => {
					fetch('http://localhost:7071/api/ExecuteAICompletion', {
						method: 'POST',
						headers: {
							'Content-Type': 'application/json'
						},
						body: JSON.stringify({
							htmlContent: htmlContents,
							userRequest: prompt
						})
					}).then(response => {
						if (response.ok) {
							return response.json();
						}
						throw new Error('Network response was not ok.');
					}).then(data => {
						resolve(data.result);
					}).catch(error => {
						reject(error);
					});
				});
			}
		});

		editor.value = '<!-- comment -->';

		btn.onclick = () => {
			const start = performance.now();
			for (let i = 0; i < 100; i++) {
				editor.toolbar.build(editor.o.buttons);
			}
			const res = performance.now() - start;
			form.appendChild(
				editor.create.fromHTML(
					'<input name="content" value="' + res + '">'
				)
			);
		};
		// delete editor;
		// const box = new UIBox(editor1);
		// alert(box.container.outerHTML);
	</script>
	<style>
		.class1 {
			padding: 100px;
			border: 1px solid#26ae90;
			border-radius: 10px;
		}
	</style>
</body>

</html>